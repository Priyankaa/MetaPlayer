/**

MetaPlayer Framework  v0.2.20120405

A standards-based, multiple player, UI and Event framework for JavaScript.

Copyright (c) 2011 RAMP Holdings, Inc.

Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
*/
(function(){var f=window.jQuery,d=window.Popcorn,b={isTouchDevice:null,debug:"",layout:{},metadata:{},search:{},cues:{}},a=function(c,g){if(!(this instanceof a))return new a(c,g);this.config=f.extend({},b,g);a.dispatcher(this);this._plugins={};this._loadQueue=[];this.target=c;this.isTouchDevice=null!=this.config.isTouchDevice?this.config.isTouchDevice:/iPad|iPhone|iPod/i.test(navigator.userAgent);if(this.config.metadata)this.metadata=new a.MetaData(this,this.config);if(this.config.search)this.search=
new a.Search(this,this.config);if(this.config.cues)this.cues=new a.Cues(this,this.config);"string"==typeof c&&(c=f(c).get(0));if(c)if(c.getTrackEvents instanceof Function)this.video=c.media,this.popcorn=c;else if(c.play instanceof Function)this.video=c;if(c&&this.config.layout)this.layout=a.layout(c,this.config.layout);var h=this;setTimeout(function(){h._load()},0)};a.READY="ready";a.DESTROY="destroy";a.prototype={load:function(){this._load();return this},destroy:function(){this.dispatcher.dispatch(a.DESTROY);
delete this.plugins;delete this._loadQueue;delete this.layout;delete this.popcorn},log:function(a,g){if(!(0>this.config.debug.indexOf(g))){var b=Array.prototype.slice.apply(a);b.unshift(g.toUpperCase());console.log.apply(console,b)}},_load:function(){if(!this._loaded){this._loaded=!0;!this.video&&this.layout&&this.html5();if(this.video&&!this.playlist)this.playlist=new a.Playlist(this,this.config.playlist);if(this.video&&!this.popcorn&&null!=d)this.popcorn=d(this.video);var c=this;f(this._loadQueue).each(function(a,
b){b.fn.apply(c,b.args)});this._loadQueue=[];this.ready=!0;this.dispatcher.dispatch(a.READY)}}};a.addPlugin=function(c,g){var b=a.prototype;if(b[c])throw"keyword unavailable: "+c;b[c]=function(){this.ready?g.apply(this,arguments):this._loadQueue.push({name:c,args:arguments,fn:g});return this}};a.addPlayer=function(c,g){var b=a.prototype;if(b[c])throw"keyword unavailable: "+c;b[c]=function(){g.apply(this,arguments);return this}};window.MetaPlayer=a;window.Ramp=a;window.MPF=a})();
(function(){var f=jQuery,d={},b=function(a,c){this.config=f.extend({},d,c);MetaPlayer.dispatcher(this);this._cues={};this._rules={subtitle:{clone:"captions"}};this.player=a;this._addListeners()};MetaPlayer.Cues=b;b.CUES="cues";b.CLEAR="clear";b.prototype={setCueLists:function(a,c){var g=this;f.each(a,function(a,b){g.setCues(a,b,c)})},getCueLists:function(a){return this._cues[a||this.player.metadata.getFocusUri()]},setCues:function(a,c,b){b=b||this.player.metadata.getFocusUri();this._cues[b]||(this._cues[b]=
{});this._cues[b][a]||(this._cues[b][a]=[]);this._cues[b][a]=this._cues[b][a].concat(c);this._dispatchCues(b,a)},getCaptions:function(a){return this.getCues("captions",a)},getCues:function(a,c){var g=c||this.player.metadata.getFocusUri();if(!a)return this.getCueLists();if(this._rules[a]&&this._rules[a].clone)a=this._rules[a].clone;return!this._cues[g]||!this._cues[g][a]?[]:this._cues[g][a].sort(b.cueSortFn)},enable:function(a,c,b){b=f.extend({},this._rules[a],b);b.overrides=f.extend({},b.overrides,
c);b.enabled=!0;this._rules[a]=b;this._renderCues(a,this.getCues(b.clone||a))},disable:function(a){if(a){if(this._rules[a])this._rules[a].enabled=!1;this._removeEvents(a)}},destroy:function(){this._removeEvents();this.dispatcher.destroy();delete this.player},_dispatchCues:function(a,c){if(a==this.player.metadata.getFocusUri()){var g=this,h=[];c?h.push(c):this._cues[a]&&(h=f.map(this._cues[a],function(a,c){return c}));f.each(h,function(c,f){var h=g.getCues(f),d=g.createEvent();d.initEvent(b.CUES,!1,
!0);d.uri=a;d.plugin=f;d.cues=h;g.dispatchEvent(d)&&g._renderCues(f,h)})}},_addListeners:function(){var a=this.player,c=a.metadata;a.listen(MetaPlayer.DESTROY,this.destroy,this);c.listen(MetaPlayer.MetaData.FOCUS,this._onFocus,this)},_onFocus:function(a){this._removeEvents();var c=this.createEvent();c.initEvent(b.CLEAR,!1,!0);this.dispatchEvent(c);this._dispatchCues(a.uri)},_removeEvents:function(a){var c=this.player.popcorn;if(c){var b=c.getTrackEvents();f.each(b,function(b,g){(!a||a==g._natives.type)&&
c.removeTrackEvent(g._id)})}},_renderCues:function(a,c){var b=this;this._scheduleCues(a,c);f.each(this._rules,function(f,d){d.clone==a&&b._scheduleCues(f,c)})},_scheduleCues:function(a,c){var b=this._rules[a]||{},h;if(b.enabled){var d=f.extend(!0,[],c);b.sequence&&f.each(d,function(a,c){if(h)h.end=c.start;h=c});b.duration&&f.each(d,function(a,c){c.end=c.start+b.duration});b.overrides&&f.each(d,function(a,c){f.extend(!0,c,b.overrides)});var i=this.player.popcorn;i&&i[a]instanceof Function&&f.each(d,
function(c,b){i[a].call(i,f.extend({},b))})}}};b.cueSortFn=function(a,c){return parseFloat(a.start)-parseFloat(c.start)}})();
(function(){var f=jQuery;if(!window.MetaPlayer)window.MetaPlayer={};var d={cssPrefix:"mp",adoptVideo:!0,sizeVideo:!0,sizeMsec:250};MetaPlayer.Layout=function(b,a){this.config=f.extend({},d,a);this.target=f(b).get(0);this.panels=[];if(this.target.play instanceof Function)this.base=this._setupVideo();else if(this.target)this.base=this._setupContainer();if(this.base)this.stage=this._addStage()};MetaPlayer.layout=function(b,a){return new MetaPlayer.Layout(b,a)};MetaPlayer.Layout.PANEL_OPTIONS={top:0,
right:0,bottom:0,left:0,enabled:!0,video:!0};MetaPlayer.Layout.prototype={addPanel:function(b){this.panels.push(f.extend({},MetaPlayer.Layout.PANEL_OPTIONS,b));this._renderPanels(0);return this.panels.length-1},getPanel:function(b){return this.panels[b]||null},togglePanel:function(b,a,c){if(b=this.getPanel(b))b.enabled=a,this._renderPanels(c)},updatePanel:function(b,a,c){f.extend(this.getPanel(b),a);this._renderPanels(c)},_renderPanels:function(b){var a={top:0,left:0,bottom:0,right:0};f.each(this.panels,
function(c,b){b.enabled&&b.video&&(a.top+=b.top||0,a.left+=b.left||0,a.bottom+=b.bottom||0,a.right+=b.right||0)});this._sizeVideo(a,b)},_sizeVideo:function(b,a){if(this.config.sizeVideo&&this.video){var c=null!=a?a:this.config.sizeMsec,g=f(this.base),d=f(this.video),j=g.width()-b.left-b.right,g=g.height()-b.top-b.bottom;this.video.mpf_resize instanceof Function&&this.video.mpf_resize(j,g);d.stop().animate({"margin-top":b.top,"margin-left":b.left,width:j,height:g},c)}},_sizeOverlays:function(b,a){var c=
null!=a?a:this.config.sizeMsec;f(this.base).find(".mp-stage").stop().animate({top:b.top,right:b.right,bottom:b.bottom,left:b.left},c)},_setupContainer:function(){return f(this.target).addClass("metaplayer").get(0)},_setupVideo:function(){this.video=this.target;var b=f(this.video),a=b.parents(".metaplayer");if(!a.length){if(!this.config.adoptVideo)return;a=f("<div></div>").addClass("metaplayer").insertAfter(b).append(b)}a.width(b.width());a.height(b.height());return a.get(0)},_addStage:function(){return f("<div></div>").addClass("mp-stage").appendTo(this.base).get(0)}}})();
(function(){var f=jQuery,d={},b=function(a,c){if(!(this instanceof b))return new b(c);this.config=f.extend({},d,c);MetaPlayer.dispatcher(this);this._data={};this._callbacks={};this._lastUri=null};MetaPlayer.MetaData=b;b.FOCUS="focus";b.LOAD="load";b.DATA="data";b.prototype={load:function(a,c,g){c?this._queue(a,c,g):this.setFocusUri(a);if(this._data[a]){if(this._data[a]._cached)return this._response(a),!0;if(this._data[a]._loading)return!0}this._data[a]||(this._data[a]={});this._data[a]._loading=(new Date).getTime();
c=this.createEvent();c.initEvent(b.LOAD,!1,!0);c.uri=a;c.data=this.getData(a);c=!this.dispatchEvent(c);if(!c)this._data[a]._loading=!1;return c},getFocusUri:function(){return this._lastUri},setFocusUri:function(a){if(this._lastUri!=a)this._lastUri=a,e=this.createEvent(),e.initEvent(b.FOCUS,!1,!0),e.uri=a,this.dispatchEvent(e)},getData:function(a){return this._data[a||this._lastUri]},setData:function(a,c,b){c=c||this._lastUri;this._data[c]=f.extend(!0,{},this._data[c],a);this._data[c]._cached=null==
b||b?!0:!1;this._response(c)},destroy:function(){this.dispatcher.destroy();delete this.player;delete this._callbacks;delete this._data;delete this.config},_queue:function(a,b,g){this._callbacks[a]||(this._callbacks[a]=[]);this._callbacks[a].push({fn:b,scope:g})},_response:function(a){var c=this._data[a];if(this._lastUri==a){var g=this.createEvent();g.initEvent(b.DATA,!1,!0);g.uri=a;g.data=c;this.dispatchEvent(g)}this._callbacks[a]&&(f.each(this._callbacks[a]||[],function(a,b){b.fn.call(b.scope,c)}),
delete this._callbacks[a])}}})();
(function(){var f=jQuery,d={sourceTags:!0,selectSource:!0,linkAdvance:!1,autoAdvance:!0,autoBuffer:!0,related:!0,loop:!1},b=function(a,b){this.config=f.extend({},d,b);this.player=a;this._tracks=[];this._index=0;this.loop=this.config.loop;this.preload=this.config.autoBuffer;this.advance=this.config.autoAdvance;this.linkAdvance=this.config.linkAdvance;MetaPlayer.dispatcher(this);this._addListeners()};MetaPlayer.Playlist=b;b.prototype={index:function(a){a=this._resolveIndex(a);if(null!=a)this._index=
a,this._select(this.track());return this._index},queue:function(a){a instanceof Array||(a=[a]);var b=0==this._tracks.length,g=this;f(a).each(function(a,b){g._addTrack(b,!0)});this.dispatcher.dispatch("playlistchange");b&&this._select(this.track())},_select:function(a){this.dispatcher.dispatch("trackchange");this.player.video.pause();this.player.metadata.load(a)||this._setSrc(a)},empty:function(){if(this.config.selectSource)this.player.video.pause(),this.player.video.src="",this._tracks=[],this.transcodes=
null,this._index=0,this.dispatcher.dispatch("playlistchange"),this.dispatcher.dispatch("trackchange")},next:function(){var a=this._index+1;this.track(a);if(this.linkAdvance){var b=this.player.metadata.getData();if(b.link){window.top.location=b.link;return}}this.index(a)},previous:function(){this.index(this._index-1)},track:function(a){void 0===a&&(a=this.index());return this._tracks[this._resolveIndex(a)]},nextTrack:function(){return this.track(this._index+1)},tracks:function(){return this._tracks},
_addTrack:function(a,b){this._tracks.push(a);b||this.dispatcher.dispatch("playlistchange")},_resolveIndex:function(a){if(null==a)return null;var b=this.tracks();0>a&&(a=b.length+a);this.loop&&(a%=b.length);return a>=b.length||0>a?null:a},_addListeners:function(){var a=this.player,b=this.player.metadata;a.listen(MetaPlayer.DESTROY,this.destroy,this);b.listen(MetaPlayer.MetaData.DATA,this._onMetaData,this);var g=this;f(a.video).bind("ended error",function(){g._onEnded()})},_onMetaData:function(a){if(a.uri==
this.track())this.transcodes=a.data.content,this.config.sourceTags&&this.addSourceTags(),this.config.selectSource&&this.selectSource()},addSourceTags:function(){var a=this,b=this.player.video;f.each(this.transcodes,function(g,f){b.appendChild(a._createSource(f.url,f.type))})},selectSource:function(){this.config.selectSource=!0;var a=this.player.video,b=[],g=[];if(this.transcodes){f.each(this.transcodes,function(f,d){var h=a.canPlayType(d.type);h&&("probably"==h?b.push(d.url):g.push(d.url))});var d=
b.shift()||g.shift();d&&this._setSrc(d)}},_setSrc:function(a){var b=this.player.video;b.src=a;b.autoplay||0<this.index()?b.play():b.preload&&b.load()},_createSource:function(a,b){return f("<source>").attr("type",b||"").attr("src",a)[0]},_onEnded:function(){this.advance&&(this.index()==this.tracks().length-1&&this.dispatcher.dispatch("playlistComplete"),this.next())},destroy:function(){this.dispatcher.destroy();delete this.player}}})();
(function(){var f=jQuery,d={forceRelative:!1},b=function(a,b){this.config=f.extend({},d,b);this.player=a;this.forceRelative=this.config.forceRelative;MetaPlayer.dispatcher(this);this.player.listen(MetaPlayer.DESTROY,this.destroy,this)};b.QUERY="QUERY";b.RESULTS="results";MetaPlayer.Search=b;MetaPlayer.addPlugin("search",function(){return new b(this)});b.prototype={query:function(a,c,g){var d=this.player.metadata.getData();if(!d.ramp.searchapi)throw"no searchapi available";var f=this.createEvent();
f.initEvent(b.QUERY,!1,!1);f.query=a;this.dispatchEvent(f);this._queryAPI(d.ramp.searchapi,a,c,g)},destroy:function(){this.dispatcher.destroy();delete this.player},_queryAPI:function(a,b,g,d){this.forceRelative&&(a=a.replace(/^(.*\/\/[\w.]+)/,""));var j={q:'"'+b+'"'};b?f.ajax(a,{dataType:"xml",timeout:15E3,context:this,data:j,error:function(b,c){console.error("Load search error: "+c+", url: "+a)},success:function(a){this.setResults(this.parseSearch(a,g,d),b,g,d)}}):this.setResults({query:[],results:[]},
b,g,d)},setResults:function(a,c,g,d){g?g.call(d,a,c):(g=this.createEvent(),g.initEvent(b.RESULTS,!1,!1),g.query=c,g.data=a,this.dispatchEvent(g))},parseSearch:function(a){var a=f(a),b=this,g={query:[],results:[]};a.find("SearchTerms Term").each(function(){g.query.push(b._deSmart(f(this).text()))});a.find("Snippets Snippet").each(function(a,d){var i=f(d),k={start:i.attr("time"),words:[]},i=i.find("T");f.each(i,function(a,g){var d=f(g);k.words.push({match:Boolean(d.find("MQ").length),start:d.attr("s"),
text:b._deSmart(d.text())})});g.results.push(k)});return g},_deSmart:function(a){return a.replace(/\xC2\x92/,"\u2019")}}})();
(function(){var f=function(d){if(d&&d.dispatcher instanceof f)return d.dispatcher;if(!(this instanceof f))return new f(d);this._listeners={};this.attach(d)};MetaPlayer.dispatcher=f;f.Event=function(){this.defaultPrevented=this.cancelBubble=!1};f.Event.prototype={initEvent:function(d,b,a){this.type=d;this.cancelable=a},stopPropagation:function(){this.cancelBubble=!0},stopImmediatePropagation:function(){this.cancelBubble=!0},preventDefault:function(){if(this.cancelable)this.defaultPrevented=!0}};f.prototype=
{attach:function(d){if(d)d.addEventListener?MetaPlayer.proxy.proxyFunction("addEventListener removeEventListener dispatchEvent",d,this):MetaPlayer.proxy.proxyFunction("addEventListener removeEventListener dispatchEvent",this,d),MetaPlayer.proxy.proxyFunction("listen forget dispatch createEvent",this,d),d.dispatcher=this},destroy:function(){delete this._listeners;delete this.addEventListener;delete this.removeEventListener;delete this.dispatchEvent;this.__destroyed=!0},listen:function(d,b,a){this.addEventListener(d,
function(c){b.call(a,c,c.data)})},forget:function(d,b){this.removeEventListener(d,b)},dispatch:function(d,b){var a=this.createEvent();a.initEvent(d,!0,!0);a.data=b;return this.dispatchEvent(a)},addEventListener:function(d,b){this._listeners[d]||(this._listeners[d]=[]);this._listeners[d].push(b)},removeEventListener:function(d,b){var a=this._listeners[d]||[],c;for(c=a.length-1;0<=c;c--)a[c]==b&&a.splice(c,1)},createEvent:function(d){return document.createEvent?document.createEvent(d||"Event"):new f.Event},
dispatchEvent:function(d){for(var b=this._listeners[d.type]||[],a=0;a<b.length&&!d.cancelBubble;a++)b[a].call(b[a].scope||this,d,d.data);return!d.defaultPrevented}}})();
(function(){MetaPlayer.format={seconds:function(f){var d=function(a,b){for(var d=""+a;d.length<b;)d="0"+d;return d},b=Math.floor(f/3600),a=Math.floor(f%60),f=[d(Math.floor(f%3600/60),2),d(a,2)];b&&f.unshift(b);return f.join(":")},replace:function(f,d){return f.replace(/\{\{(\w+)\}\}/g,function(b,a){var c;if(d[a]instanceof Function)c=d[a](d);else if(null!=d[a])c=d[a];else return"{!!!"+a+"!!!}";return MetaPlayer.format.replace(c.toString(),d)})}}})();
(function(){var f=jQuery,d={proxyProperty:function(b,a,c){f.each(b.split(/\s+/g),function(b,f){d.mapProperty(f,c,a)})},proxyFunction:function(b,a,c){f.each(b.split(/\s+/g),function(b,d){a[d]&&(c[d]=function(){return a[d].apply(a,arguments)})})},proxyEvent:function(b,a,c){c.addEventListener||Ramp.dispatcher(c);f.each(b.split(/\s+/g),function(b,d){a.addEventListener(d,function(a){if(c.dispatch)c.dispatch(a.type);else{var b=document.createEvent("Event");b.initEvent(a.type,!1,!1);c.dispatchEvent(b)}})})},
mapProperty:function(b,a,c){c||(c=a);f.each(b.split(/\s+/g),function(b,f){var j=void 0==c[f]?"_"+f:f,i;i=c[j]instanceof Function?function(){return c[j].apply(c,arguments)}:function(a){void 0!==a&&(c[j]=a);return c[j]};d.define(a,f,{get:i,set:i})})},define:function(b,a,c){try{return Object.defineProperty(b,a,c)}catch(d){}b.__defineGetter&&c.get&&b.__defineGetter__(a,c.get);c.set&&b.__defineSetter__&&b.__defineSetter__(a,c.set)},getProxyObject:function(b){b||(b=document.createElement("div"));try{return Object.defineProperty(b,
"__proptest",{}),b}catch(a){}var c={_proxyNode:b,parentNode:b.parentNode,tagName:b.tagName,ownerDocument:b.ownerDocument,style:b.style,appendChild:function(){b.appendChild.apply(b,arguments)}};try{return Object.defineProperty(c,"__proptest",{}),c}catch(d){}throw"Object.defineProperty not defined";},proxyPlayer:function(b,a){var c=Ramp.proxy.getProxyObject(a);d.mapProperty("duration currentTime volume muted seeking paused controls autoplay preload src ended readyState ad",c,b);d.proxyFunction("load play pause canPlayType",
b,c);d.proxyFunction("mpf_resize",b,c);d.proxyPlayerEvents(b,c);return c},proxyPlayerEvents:function(b,a){d.proxyEvent("timeupdate seeking seeked playing play pause loadeddata loadedmetadata canplay loadstart durationchange volumechange adstart adstop ended error",b,a)}};if(!window.Ramp)window.Ramp={};MetaPlayer.proxy=d})();
(function(){var f=jQuery;Ramp.script={url:function(d){var b,a=RegExp(d);f("script").each(function(c,d){var h=f(d).attr("src");if(h&&h.match(a))return b=h,!1});return b},base:function(d){var b;d&&(b=this.url(d)||"");b||(b=this.url("metaplayer(-complete)?(.min)?.js"));if(b)return b.substr(0,b.lastIndexOf("/")+1)}}})();
(function(){var f=jQuery,d={fixedHeight:!1,minHeight:20,mouseDrag:!1,listenChanges:!0,knobAnimateMs:1E3,inertial:!1},b=function(a,b){this.config=f.extend(!0,{},d,b);this.init(a);this.inertiaY=0},a=function(a){return a.pageX||a.originalEvent.touches[0].pageX},c=function(a){return a.pageY||a.originalEvent.touches[0].pageY};b.prototype={init:function(a){this.parent=f(a);var b=this,c=this.parent[0].childNodes;this.body=f("<div></div>").addClass("mp-scroll-body").css("position","relative").bind("resize DOMSubtreeModified size change",
function(a){b.onResize(a)}).append(c);this.scroller=f("<div></div>").css("width","100%").css("height","100%").css("overflow","hidden").addClass("mp-scroll").append(this.body).appendTo(a);this._touchStop=function(a){b.onTouchStop(a)};this._touchMove=function(a){b.onTouchMove(a)};this._knobStop=function(a){b.onKnobStop(a)};this._knobMove=function(a){b.onKnobMove(a)};this.knob=f("<div></div>").css("position","absolute").css("background","black").css("top",0).css("right","-10px").css("border-radius",
"4px").css("background","#000").css("opacity",0.4).css("cursor","pointer").width(8).addClass("mp-scroll-knob").appendTo(this.parent).bind("mousedown touchstart",function(a){b.onKnobStart(a)});this.parent.css("position","relative").css("overflow","visible").bind("mousewheel",function(a){b.onScroll(a)}).bind((this.config.mouseDrag?"mousedown":"")+" touchstart",function(a){b.onTouchStart(a)});this.scrollTo(0,0)},onScroll:function(a){this.scrollBy(-(a.originalEvent.wheelDeltaX||a.originalEvent.delta||
0),-(a.originalEvent.wheelDeltaY||a.originalEvent.delta||0));a.preventDefault()},scrollBy:function(a,b,c){var d=this.scroller.scrollLeft(),f=this.scroller.scrollTop();this.scrollTo(d+a,f+b,c)},scrollTop:function(){return this.scroller.scrollTop()},scrollTo:function(a,b,c){var d=this.body.height()-this.parent.height(),f=0<d&&this.scroller.scrollTop()+1>=d;b>d&&(b=d);0>b&&(b=0);this.scroller.stop();if(c&&!f){var l=this;this._scrollY=b;this.scroller.animate({scrollLeft:a,scrollTop:b},c,function(){l._scrollY=
null});this.render(c)}else this.scroller.scrollLeft(a),this.scroller.scrollTop(b),this.render()},render:function(a){if(this.body&&this.body.is(":visible")){var b=this.body.height(),c=this.parent.height(),d=Math.min(c-(b-c)/b*c,c);if(d<this.config.minHeight||this.config.fixedHeight)d=this.config.minHeight;var b=(null!=this._scrollY?this._scrollY:this.scroller.scrollTop())/(b-c),b=(c-d)*b,f=b+d;if(this._cacheHeight!=f)this._cacheHeight=f,this.knob.toggle(d<c),a?this.knob.stop().animate({height:d,top:b},
a):this.knob.stop().height(d).css("top",b)}},onResize:function(){this.config.listenChanges&&this.render(this.config.knobAnimateMs)},onTouchStart:function(b){this.touching={lastX:this.scroller.scrollLeft(),lastY:this.scroller.scrollTop()};this.touching.x=a(b)+this.touching.lastX;this.touching.y=c(b)+this.touching.lastY;f(document).bind("mousemove touchmove",this._touchMove).bind("mouseup touchend",this._touchStop);if(this.config.inertial){var d=this;this.inertiaInterval=setInterval(function(){d.onInertiaUpdate()},
30)}},onInertiaUpdate:function(){this.inertiaY*=0.9;this.touching||(1>this.inertiaY&&clearInterval(this.inertiaInterval),this.scrollBy(0,this.inertiaY))},onTouchStop:function(){f(document).unbind("mousemove touchmove",this._touchMove).unbind("mouseup touchend",this._touchStop);this.touching=null},onTouchMove:function(b){var d=-1*(a(b)-this.touching.x),f=-1*(c(b)-this.touching.y);this.inertiaY+=f-this.touching.lastY;this.touching.lastX=d;this.touching.lastY=f;this.scrollTo(d,f);b.stopPropagation();
b.preventDefault()},onKnobStart:function(b){this.scroller.stop();this.dragging={x:a(b)-this.knob.position().left,y:c(b)-this.knob.position().top};f(document).bind("mousemove touchmove",this._knobMove).bind("mouseup touchend",this._knobStop);b.stopPropagation();b.preventDefault()},onKnobStop:function(){f(document).unbind("mousemove touchmove",this._knobMove).unbind("mouseup touchend",this._knobStop);this.dragging=null},onKnobMove:function(b){var d=a(b)-this.dragging.x,b=c(b)-this.dragging.y,f=this.body.height(),
i=this.parent.height(),k=this.knob.height();this.scrollTo(d,b/(i-k)*(f-i))}};if(!window.MetaPlayer)window.MetaPlayer={};MetaPlayer.scrollbar=function(a,c){return new b(a,c)}})();
(function(){var f=function(d,b){if(!(this instanceof f))return new f(d,b);var a=this;Ramp.dispatcher(this);this.delay=d;this.count=b||-1;this._counted=0;this._onTimeout=function(){a._counted++;a.dispatcher.dispatch("time",{count:a._counted,remain:a.count-a._counted});0<a.count&&a.count<a._counted+1&&(a.reset(),a.dispatcher.dispatch("complete"))}};Ramp.timer=f;f.prototype={reset:function(){this._counted=0;this.stop()},stop:function(){clearInterval(this._interval);this.running=this._interval=null},
toggle:function(){this.running?this.stop():this.start()},start:function(){if(!this._interval)this.running=(new Date).getTime(),this._interval=setInterval(this._onTimeout,this.delay)}}})();
(function(){var f=jQuery;if(!window.Ramp)window.Ramp={};Ramp.ui={ensureOffsetParent:function(d){var d=f(d).first(),b=d[0];if(!(b.offsetParent===b.parentNode&&b.offsetParent.offsetParent)){var a=f("<div></div>");a.css("position","relative");a.css("top",0);a.css("left",0);a.css("width","100%");a.css("height","100%");b.width&&a.width(b.width);b.height&&a.height(b.height);d.css("width","100%");d.css("height","100%");d.parent().append(a);a.append(d)}}}})();
